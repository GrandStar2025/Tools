!function(t){function e(r){if(i[r])return i[r].exports;var s=i[r]={exports:{},id:r,loaded:!1};return t[r].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){var r,s;r=i(1),s=function(t){var e,i,s,n;return e=new r(t.width,t.height),0===t.index?e.writeHeader():e.firstFrame=!1,e.setTransparent(t.transparent),e.setRepeat(t.repeat),e.setDelay(t.delay),e.setQuality(t.quality),e.setDither(t.dither),e.setGlobalPalette(t.globalPalette),e.addFrame(t.data),t.last&&e.finish(),t.globalPalette===!0&&(t.globalPalette=e.getGlobalPalette()),i=e.stream(),s=new Uint8Array(i.pages.length),n=0,i.pages.forEach(function(t){s.set(t,n),n+=t.length}),postMessage(s)},this.onmessage=function(t){return s(t.data)}},function(t,e){function i(){this.page=-1,this.pages=[],this.newPage()}function r(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new i}var s=i;i.prototype={getData:function(){return this.pages[this.page]},cursor:0,getData:function(){return this.pages[this.page]},newPage:function(){this.pages[++this.page]=new Uint8Array(65536),this.cursor=0},byteCursor:0,byteCount:0,writeByte:function(t){this.cursor>=65536&&this.newPage(),this.pages[this.page][this.cursor++]=t},writeUTFBytes:function(t){for(var e=t.length,i=0;e>i;i++)this.writeByte(t.charCodeAt(i))},writeBytes:function(t,e,i){for(var r=i||t.length,s=e||0;r>s;s++)this.writeByte(t[s])}},r.prototype.setDelay=function(t){this.delay=Math.round(t/10)},r.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)},r.prototype.setDispose=function(t){this.dispose=t},r.prototype.setRepeat=function(t){this.repeat=t},r.prototype.setTransparent=function(t){this.transparent=t},r.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),this.globalPalette===!0&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.globalPalette||this.writePalette(),this.writePixels(),this.firstFrame=!1},r.prototype.finish=function(){this.out.writeByte(59)},r.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t},r.prototype.setDither=function(t){t===!0&&(t="FloydSteinberg"),this.dither=t},r.prototype.setGlobalPalette=function(t){this.globalPalette=t},r.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette},r.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")},r.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new n(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.match("FloydSteinberg")?"FloydSteinberg":"FalseFloydSteinberg"):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,this.transparent!==null&&(this.transIndex=this.findClosest(this.transparent,!0))},r.prototype.indexPixels=function(){var t=this.pixels.length/3;this.indexedPixels=new Uint8Array(t);for(var e=0,i=0;t>e;e++){var r=this.findClosestRGB(this.pixels[i++]&255,this.pixels[i++]&255,this.pixels[i++]&255);this.usedEntry[r]=!0,this.indexedPixels[e]=r}},r.prototype.ditherPixels=function(t){var e={FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[.25,1,1]]},i=e[t];for(var r=0;r<this.height;r++)for(var s=0;s<this.width;s++){var n=r*this.width+s,a=3*n,o=this.pixels[a],h=this.pixels[a+1],l=this.pixels[a+2],u=this.findClosestRGB(o&255,h&255,l&255);this.usedEntry[u]=!0,this.indexedPixels[n]=u;for(var p=this.findClosestRGB(o,h,l),f=[o-this.colorTab[3*p],h-this.colorTab[3*p+1],l-this.colorTab[3*p+2]],c=0;c<i.length;c++){var d=s+i[c][1],g=r+i[c][2];if(d>=0&&d<this.width&&g>=0&&g<this.height){var y=i[c][0],v=g*this.width+d,m=3*v;this.pixels[m]=Math.max(0,Math.min(255,this.pixels[m]+f[0]*y)),this.pixels[m+1]=Math.max(0,Math.min(255,this.pixels[m+1]+f[1]*y)),this.pixels[m+2]=Math.max(0,Math.min(255,this.pixels[m+2]+f[2]*y))}}}},r.prototype.findClosest=function(t,e){return this.findClosestRGB((t&16711680)>>16,(t&65280)>>8,t&255,e)},r.prototype.findClosestRGB=function(t,e,i,r){if(this.colorTab===null)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(t,e,i);for(var s=0,n=16777216,a=this.colorTab.length,o=0,h=0;a>o;){var l=t-(this.colorTab[o++]&255),u=e-(this.colorTab[o++]&255),p=i-(this.colorTab[o]&255),f=l*l+u*u+p*p;(!r||this.usedEntry[h/3])&&n>f&&(n=f,s=h/3),o++,h+=3}return s},r.prototype.getImagePixels=function(){var t=this.width,e=this.height;this.pixels=new Uint8Array(t*e*3);for(var i=this.image,r=0,s=0,n=0;e>n;n++)for(var a=0;t>a;a++){var o=n*t*4+4*a;this.pixels[r++]=i[o],this.pixels[r++]=i[o+1],this.pixels[r++]=i[o+2]}},r.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);var t,e;this.transparent===null?(t=0,e=0):(t=1,e=2),this.dispose>=0&&(e=dispose&7),e<<=2,this.out.writeByte(0|e|0|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},r.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},r.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},r.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},r.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=3*256-this.colorTab.length,e=0;t>e;e++)this.out.writeByte(0)},r.prototype.writeShort=function(t){this.out.writeByte(t&255),this.out.writeByte(t>>8&255)},r.prototype.writePixels=function(){var t=new a(this.width,this.height,this.indexedPixels,this.colorDepth);t.encode(this.out)},r.prototype.stream=function(){return this.out},t.exports=r;var n=function(){function t(e,i){if(i=i||10,e.length<24||e.length%3!==0)throw new Error("Image data is not divisible by 3");this.pixels=e,this.samplefac=i,this.network=new Array(t.NETSIZE),this.netindex=new Int32Array(256),this.bias=new Int32Array(t.NETSIZE),this.freq=new Int32Array(t.NETSIZE),this.radpower=new Int32Array(t.INITRAD),this.network[0]=new Int32Array([0,0,0]),this.network[1]=new Int32Array([255,255,255]);for(var r=1;r<t.NETSIZE-1;r++){var s=r*3;this.network[r]=new Int32Array([s*t.PRIMES[0]%255,s*t.PRIMES[1]%255,s*t.PRIMES[2]%255])}this.reset()}return t.NETSIZE=256,t.PRIMES=[499,491,487,503],t.INITRAD=t.NETSIZE>>3,t.INITBIASRADIUS=t.INITRAD*t.NETSIZE,t.RADIUSBIASSHIFT=6,t.RADIUSBIAS=1<<t.RADIUSBIASSHIFT,t.INITBIASALPHA=1024,t.ALPHABIASSHIFT=10,t.INITALPHA=1<<t.ALPHABIASSHIFT,t.GAMMA=1024,t.BETA=1/1024,t.BETAGAMMA=t.BETA*t.GAMMA,t.prototype={reset:function(){this.network[0]=new Int32Array([0,0,0]),this.network[1]=new Int32Array([255,255,255]);for(var e=0;e<t.NETSIZE;e++)this.freq[e]=t.INITBIASRADIUS/t.NETSIZE,this.bias[e]=0;this.freq[0]=t.INITBIASRADIUS,this.freq[1]=t.INITBIASRADIUS,this.spec_init()},spec_init:function(){for(var e=0;e<t.NETSIZE;e++)this.radpower[e]=Math.floor(t.ALPHA*(t.INITRAD-e)/t.INITRAD*t.RADIUSBIAS)},contest:function(t,e,i){for(var r=this.network,s=this.netindex,n=t.length,a=0,o=Number.MAX_VALUE,h=0;h<n;h++){var l=r[h],u=Math.abs(l[0]-t)+Math.abs(l[1]-e)+Math.abs(l[2]-i);o>u&&(o=u,a=h)}return a},learn:function(){var e=this.pixels,i=e.length,r=this.samplefac,s=i/(3*r),n=Math.floor(s/t.NCYCLES),a=new Int32Array(3),o=0,h=t.INITRAD,l=h>>t.RADIUSBIASSHIFT;l<=1&&(l=0);for(var u=0;u<l;u++)this.radpower[u]=Math.floor(t.ALPHA*(h*h-u*u*t.RADIUSBIAS)/(h*h));var p=i<8*r?1:i%(8*r)===0?8:i%(4*r)===0?4:i%(2*r)===0?2:1,f=0;for(u=0;s>u;){var c=e[f],d=e[f+1],g=e[f+2],y=this.contest(c,d,g);this.altersingle(t.ALPHA>>t.ALPHABIASSHIFT,y,c,d,g),0!==l&&this.alterneigh(l,y,c,d,g),f+=p*3,f>=i&&(f-=i),o++,0===o%n&&(t.ALPHA=Math.floor(t.ALPHA*t.BETA),h=Math.floor(h*t.BETA),l=h>>t.RADIUSBIASSHIFT,l<=1&&(l=0),y=0;l>y;y++)this.radpower[y]=Math.floor(t.ALPHA*(h*h-y*y*t.RADIUSBIAS)/(h*h))}},altersingle:function(t,e,i,r,s){var n=this.network[e];n[0]-=t*(n[0]-i)/t.INITALPHA,n[1]-=t*(n[1]-r)/t.INITALPHA,n[2]-=t*(n[2]-s)/t.INITALPHA},alterneigh:function(t,e,i,r,s){for(var n=e-t;0>n;)n+=this.network.length;for(var a=e+t;a>=this.network.length;)a-=this.network.length;var o=this.radpower;for(var h=e+1;a>=h;h++){var l=this.network[h],u=o[h-e];l[0]-=u*(l[0]-i)/t.RADIUSBIAS,l[1]-=u*(l[1]-r)/t.RADIUSBIAS,l[2]-=u*(l[2]-s)/t.RADIUSBIAS}for(h=n;e>h;h++){var l=this.network[h],u=o[e-h];l[0]-=u*(l[0]-i)/t.RADIUSBIAS,l[1]-=u*(l[1]-r)/t.RADIUSBIAS,l[2]-=u*(l[2]-s)/t.RADIUSBIAS}},buildColormap:function(){this.learn(),this.unbiasnet(),this.inxbuild()},unbiasnet:function(){for(var e=0;e<t.NETSIZE;e++){var i=this.network[e];i[0]>>=t.NETBIASSHIFT,i[1]>>=t.NETBIASSHIFT,i[2]>>=t.NETBIASSHIFT,this.network[e]=i}},inxbuild:function(){for(var t=0,e=0;e<t.NETSIZE;e++){var i=this.network[e],r=e,s=i[1];for(var n=e+1;n<t.NETSIZE;n++){var a=this.network[n];a[1]<s&&(r=n,s=a[1])}var a=this.network[r];e!=r&&(t++,this.network[r]=this.network[e],this.network[e]=a)}for(var e=0;e<t.NETSIZE;e++)this.netindex[e]=e},inxsearch:function(t,e,i){for(var r=1e3,s=-1,n=this.netindex[e],a=n-1;n<t.NETSIZE||a>=0;)if(n<t.NETSIZE){var o=this.network[n];o[1]>r?n=t.NETSIZE:(n++,Math.abs(o[0]-t)+Math.abs(o[1]-e)+Math.abs(o[2]-i)<r&&(r=Math.abs(o[0]-t)+Math.abs(o[1]-e)+Math.abs(o[2]-i),s=o[3]))}if(a>=0){var o=this.network[a];o[1]<r?a=-1:(a--,Math.abs(o[0]-t)+Math.abs(o[1]-e)+Math.abs(o[2]-i)<r&&(r=Math.abs(o[0]-t)+Math.abs(o[1]-e)+Math.abs(o[2]-i),s=o[3]))}return s},lookupRGB:function(t,e,i){var r=this.inxsearch(t,e,i);return r}},t}(),a=function(){function t(t,e,i,r){function s(t,e){h[f++]=t,f>=254&&n(e)}function n(t){if(f>0){t.writeByte(f);var e=0;for(;f>e;++e)t.writeByte(h[e]);f=0}}function a(t){u[t]&=l[p],0===p&&(n(e),u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=15)}var o=Math.max(2,r),h=new Array(256),l=[31,15,7,3,1,0,0,0,0,0,0,0,0,0,0,0],u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=15,f=0,c=r,d=o,g=1<<r,y=g+1,v=g+2,m=0,w=!1,b=0,x=0,P=0,T=0,S=0,E=0,_=t,A=0,C=e*t,k=new Array(g+v),I=new Array(4096),R=new Array(4096),U=new Array(4097);for(m=0;g>m;++m)k[m]=0;for(m=0;4096>m;++m)I[m]=0;for(m=0;4096>m;++m)R[m]=0;for(m=0;4097>m;++m)U[m]=0;var B={};this.encode=function(t){t.writeByte(o);var i=0;for(i=0;C>i;++i){var r=i%_,h=Math.floor(i/_);if(0==r){if(h!=E){for(m=g;v>m;++m)k[m]=0;w=!1,E=h}}var l=P+r*3,u=i%_==0?0:1,p=B[l];if(void 0===p){b=e[l++]&255<<16|e[l++]&255<<8|e[l++]&255,p=k[b],0==p&&(p=y),B[l]=p}if(0==p)T=b,S=y,k[b]=S,U[S]=b,R[S]=0,S++,S>=4096?(a(x),S=v,d=o,c=r):S>=1<<d&&d<12&&d++;else{T=p;var f=p;if(f==y&&(f=x,U[S]=b),f>=S)return;for(;f>g;)U[S]=R[f],f=I[f];b=255&U[f],U[S]=b,S>=4096?(a(x),S=v,d=o,c=r):S>=1<<d&&d<12?(d++,c=r):(c++,c==d&&(c=r)),I[S]=x,R[S]=T,x=f,S++}u&&(s(x,t),w=!0)}s(x,t),s(y,t),n(t)}}return t}();t.exports=r}]); 