<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loan EMI Calculator - Calculate Monthly Loan Payments | Multi-Tools</title>
    <meta name="description" content="Free online loan EMI calculator. Calculate monthly loan payments, total interest, and view complete amortization schedule.">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../../css/styles.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Google AdSense Code - Add your AdSense code here -->
    <!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX" crossorigin="anonymous"></script> -->

    <style>
        .tool-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .tool-header {
            background: linear-gradient(45deg, #0d6efd, #0099ff);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            text-align: center;
        }
        .tool-header .tool-description {
            color: white;
            opacity: 0.9;
            font-size: 1.1rem;
            margin-bottom: 0;
        }
        .calculator-card {
            border: none;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
        }
        .calculator-card .card-header {
            background-color: #f8f9fa;
            border-bottom: none;
            padding: 1rem;
        }
        .calculator-card .card-body {
            padding: 1.5rem;
        }
        .result-box {
            background-color: #f8f9fa;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
        }
        .result-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #0d6efd;
            margin-bottom: 0.5rem;
        }
        .result-label {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 0.25rem;
        }
        .chart-container {
            position: relative;
            height: 200px;
            margin: 1rem 0;
        }
        .input-group-text {
            background-color: #f8f9fa;
        }
        .table th {
            background-color: #f8f9fa;
        }
        
        /* Currency Select Styling */
        .currency-option {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 4px;
        }
        .currency-flag {
            width: 28px !important;
            height: 20px !important;
            object-fit: cover;
            border-radius: 3px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid rgba(0,0,0,0.1);
        }
        .currency-symbol {
            color: #666;
            font-weight: 500;
        }
        #currencySelect {
            padding-left: 35px;
            background-position: 10px center;
            background-repeat: no-repeat;
            background-size: 20px 15px;
        }
        #currencySelect option {
            padding: 8px 8px 8px 35px !important;
            background-repeat: no-repeat;
            background-position: 8px center;
            background-size: 20px 15px;
            min-height: 30px;
            display: flex;
            align-items: center;
        }
        /* Custom select styling */
        .currency-select-wrapper {
            position: relative;
            max-width: 300px;
        }
        .currency-select-wrapper .flag-icon {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 15px;
            pointer-events: none;
        }
        /* Style for the custom dropdown */
        .custom-select-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        .custom-select-dropdown.show {
            display: block;
        }
        .custom-select-option {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            cursor: pointer;
            gap: 12px;
            transition: all 0.2s ease;
        }
        .custom-select-option:hover {
            background-color: #f8f9fa;
        }
        .custom-select-option img {
            width: 28px !important;
            height: 20px !important;
            object-fit: cover;
            border-radius: 3px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid rgba(0,0,0,0.1);
        }
        .custom-select-option .currency-code {
            font-weight: 600;
            color: #333;
            min-width: 50px;
        }
        .custom-select-option .currency-name {
            color: #666;
            font-size: 0.95em;
        }
        .currency-select {
            max-width: 300px;
        }
        .currency-select option {
            padding: 8px;
            display: flex;
            align-items: center;
        }
        .currency-select option::before {
            content: "";
            display: inline-block;
            width: 24px;
            height: 16px;
            margin-right: 8px;
            background-size: contain;
            background-repeat: no-repeat;
            vertical-align: middle;
        }
        /* Add flag background for selected currency */
        .currency-flag {
            width: 24px;
            height: 16px;
            display: inline-block;
            margin-right: 8px;
            background-size: contain;
            background-repeat: no-repeat;
            vertical-align: middle;
        }
        /* Currency Selector Styling */
        .currency-select-container {
            position: relative;
            min-width: 250px;
            max-width: 300px;
        }
        .selected-currency {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            cursor: pointer;
            background: white;
            gap: 10px;
            transition: all 0.2s ease;
        }
        .selected-currency:hover {
            background-color: #f8f9fa;
            border-color: #c1c9d0;
        }
        .selected-currency i {
            margin-left: auto;
            color: #6c757d;
        }
        .currency-info {
            display: flex;
            flex-direction: column;
        }
        .currency-search {
            margin-top: 8px;
            margin-bottom: 8px;
        }
        .currency-search input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            font-size: 0.95em;
        }
        .currency-search input:focus {
            outline: none;
            border-color: #0d6efd;
            box-shadow: 0 0 0 0.2rem rgba(13,110,253,.25);
        }
        .currency-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
            z-index: 1000;
            display: none;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 4px;
        }
        .currency-dropdown.show {
            display: block;
        }
        .currency-list {
            max-height: 350px;
            overflow-y: auto;
        }
        .currency-group {
            padding: 8px 12px;
            background: #f8f9fa;
            font-weight: 600;
            color: #495057;
            font-size: 0.9em;
            position: sticky;
            top: 0;
            z-index: 1;
            border-bottom: 1px solid #dee2e6;
        }
        .currency-option {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            cursor: pointer;
            gap: 10px;
            transition: background-color 0.2s;
        }
        .currency-option:hover {
            background-color: #f8f9fa;
        }
        .currency-flag {
            width: 24px !important;
            height: 18px !important;
            border-radius: 2px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            border: 1px solid rgba(0,0,0,0.1);
        }
        .currency-code {
            font-weight: 600;
            color: #333;
            min-width: 45px;
        }
        .currency-name {
            color: #666;
            font-size: 0.9em;
        }
        .no-results {
            padding: 12px;
            text-align: center;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <!-- Header will be loaded dynamically -->
    <div id="header-placeholder"></div>

    <!-- Tool Header -->
    <div class="tool-header">
        <div class="container">
            <h1><i class="fas fa-calculator me-2"></i>Loan EMI Calculator</h1>
            <p class="tool-description">
                Calculate your monthly loan payments (EMI) and view complete amortization schedule
            </p>
        </div>
    </div>

    <main class="container-fluid py-4">
        <div class="row">
            <!-- Left Sidebar - Ads -->
            <div class="col-lg-2">
                <div class="sticky-top" style="top: 2rem;">
                    <!-- Google AdSense - Vertical Ad Left -->
                    <!-- Replace this div with your AdSense code for vertical ad -->
                    <div class="ad-placeholder">
                        <div class="card mb-4">
                            <div class="card-body text-center">
                                <div class="ad-space vertical-ad">
                                    <!-- AdSense Vertical Ad Code Here -->
                                    <!-- Example: -->
                                    <!-- <ins class="adsbygoogle"
                                         style="display:block"
                                         data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
                                         data-ad-slot="XXXXXXXXXX"
                                         data-ad-format="vertical"
                                         data-full-width-responsive="true"></ins>
                                    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> -->
                                    Advertisement
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content Column -->
            <div class="col-lg-8">
                <div class="tool-container">
                    <!-- EMI Calculator -->
                    <div class="card calculator-card">
                        <div class="card-header">
                            <h2 class="h5 mb-0">Calculate EMI</h2>
                        </div>
                        <div class="card-body">
                            <!-- Currency Selector -->
                            <div class="input-group mb-3">
                                <span class="input-group-text" id="currencySymbol">$</span>
                                <div class="currency-select-container">
                                    <div class="selected-currency" id="selectedCurrency">
                                        <img src="https://flagcdn.com/w40/us.png" alt="USD flag" class="currency-flag" id="selectedFlag">
                                        <div class="currency-info">
                                            <span class="currency-code" id="selectedCode">USD</span>
                                            <span class="currency-name" id="selectedName">US Dollar</span>
                                        </div>
                                        <i class="fas fa-chevron-down"></i>
                                    </div>
                                    <div class="currency-search">
                                        <input type="text" id="currencySearchInput" placeholder="Search currency...">
                                    </div>
                                    <div class="currency-dropdown" id="currencyDropdown">
                                        <div class="currency-list" id="currencyList">
                                            <!-- Currency options will be populated here -->
                                        </div>
                                    </div>
                                </div>
                                <input type="number" class="form-control" id="loanAmount" placeholder="Enter loan amount" aria-label="Loan Amount">
                            </div>

                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="interestRate" class="form-label">Interest Rate (% per year)</label>
                                    <div class="input-group">
                                        <input type="number" class="form-control" id="interestRate" placeholder="Enter interest rate">
                                        <span class="input-group-text">%</span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label for="loanTerm" class="form-label">Loan Term</label>
                                    <div class="input-group">
                                        <input type="number" class="form-control" id="loanTerm" placeholder="Enter loan term">
                                        <select class="form-select" id="termType" style="max-width: 100px;">
                                            <option value="12">Years</option>
                                            <option value="1">Months</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Results Section -->
                            <div class="result-box mt-4">
                                <div class="row">
                                    <div class="col">
                                        <h3 class="h6 mb-3">Loan Summary:</h3>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <p class="result-label">Monthly EMI:</p>
                                                <p class="result-value" id="monthlyEMI">$0</p>
                                            </div>
                                            <div class="col-md-4">
                                                <p class="result-label">Total Interest:</p>
                                                <p class="result-value" id="totalInterest">$0</p>
                                            </div>
                                            <div class="col-md-4">
                                                <p class="result-label">Total Payment:</p>
                                                <p class="result-value" id="totalPayment">$0</p>
                                            </div>
                                        </div>
                                        <div class="chart-container">
                                            <canvas id="loanChart"></canvas>
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <button class="btn btn-primary" onclick="calculateEMI()">
                                            Calculate EMI
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Amortization Schedule -->
                    <div class="card calculator-card">
                        <div class="card-header">
                            <h2 class="h5 mb-0">Amortization Schedule</h2>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="amortizationTable">
                                    <thead>
                                        <tr>
                                            <th>Month</th>
                                            <th>EMI</th>
                                            <th>Principal</th>
                                            <th>Interest</th>
                                            <th>Balance</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Will be populated by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Tips Section -->
                    <div class="card calculator-card">
                        <div class="card-header">
                            <h2 class="h5 mb-0">Tips & Information</h2>
                        </div>
                        <div class="card-body">
                            <ul class="mb-0">
                                <li>EMI = Equated Monthly Installment</li>
                                <li>Enter loan amount, interest rate, and term</li>
                                <li>View monthly payment breakdown</li>
                                <li>See complete amortization schedule</li>
                                <li>Interest is calculated on reducing balance</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Sidebar - Ads -->
            <div class="col-lg-2">
                <div class="sticky-top" style="top: 2rem;">
                    <!-- Tips Card -->
                    <div class="card mb-4">
                        <div class="card-header">
                            <h3 class="h5 mb-0">Quick Tips</h3>
                        </div>
                        <div class="card-body">
                            <ul class="list-unstyled mb-0 small">
                                <li class="mb-2">✓ Calculate monthly EMI</li>
                                <li class="mb-2">✓ View interest breakdown</li>
                                <li class="mb-2">✓ See payment schedule</li>
                                <li>✓ Real-time calculations</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Google AdSense - Vertical Ad Right -->
                    <!-- Replace this div with your AdSense code for vertical ad -->
                    <div class="ad-placeholder">
                        <div class="card">
                            <div class="card-body text-center">
                                <div class="ad-space vertical-ad">
                                    <!-- AdSense Vertical Ad Code Here -->
                                    <!-- Example: -->
                                    <!-- <ins class="adsbygoogle"
                                         style="display:block"
                                         data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
                                         data-ad-slot="YYYYYYYYYY"
                                         data-ad-format="vertical"
                                         data-full-width-responsive="true"></ins>
                                    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> -->
                                    Advertisement
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer will be loaded dynamically -->
    <div id="footer-placeholder"></div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Custom JavaScript -->
    <script src="../../js/main.js"></script>
    <script>
        let loanChart = null;
        
        // Currency symbols mapping
        const currencySymbols = {
            // Popular Currencies
            'USD': '$', 'EUR': '€', 'GBP': '£', 'INR': '₹', 'JPY': '¥',
            'CNY': '¥', 'AUD': 'A$', 'CAD': 'C$', 'CHF': 'CHF', 'HKD': 'HK$',
            
            // All World Currencies
            'AED': 'د.إ', 'AFN': '؋', 'ALL': 'L', 'AMD': '֏', 'ANG': 'ƒ',
            'AOA': 'Kz', 'ARS': '$', 'AWG': 'ƒ', 'AZN': '₼', 'BAM': 'KM',
            'BBD': '$', 'BDT': '৳', 'BGN': 'лв', 'BHD': '.د.ب', 'BIF': 'FBu',
            'BMD': '$', 'BND': '$', 'BOB': 'Bs.', 'BRL': 'R$', 'BSD': '$',
            'BTN': 'Nu.', 'BWP': 'P', 'BYN': 'Br', 'BZD': 'BZ$', 'CDF': 'FC',
            'CLP': '$', 'COP': '$', 'CRC': '₡', 'CUP': '₱', 'CVE': '$',
            'CZK': 'Kč', 'DJF': 'Fdj', 'DKK': 'kr', 'DOP': 'RD$', 'DZD': 'د.ج',
            'EGP': '£', 'ERN': 'Nfk', 'ETB': 'Br', 'FJD': '$', 'FKP': '£',
            'GEL': '₾', 'GHS': '₵', 'GIP': '£', 'GMD': 'D', 'GNF': 'FG',
            'GTQ': 'Q', 'GYD': '$', 'HNL': 'L', 'HRK': 'kn', 'HTG': 'G',
            'HUF': 'Ft', 'IDR': 'Rp', 'ILS': '₪', 'IQD': 'ع.د', 'IRR': '﷼',
            'ISK': 'kr', 'JMD': 'J$', 'JOD': 'د.ا', 'KES': 'KSh', 'KGS': 'с',
            'KHR': '៛', 'KMF': 'CF', 'KPW': '₩', 'KRW': '₩', 'KWD': 'د.ك',
            'KYD': '$', 'KZT': '₸', 'LAK': '₭', 'LBP': 'ل.ل', 'LKR': '₨',
            'LRD': '$', 'LSL': 'L', 'LYD': 'ل.د', 'MAD': 'د.م.', 'MDL': 'L',
            'MGA': 'Ar', 'MKD': 'ден', 'MMK': 'K', 'MNT': '₮', 'MOP': 'MOP$',
            'MRU': 'UM', 'MUR': '₨', 'MVR': '.ރ', 'MWK': 'MK', 'MXN': '$',
            'MYR': 'RM', 'MZN': 'MT', 'NAD': '$', 'NGN': '₦', 'NIO': 'C$',
            'NOK': 'kr', 'NPR': '₨', 'NZD': '$', 'OMR': 'ر.ع.', 'PAB': 'B/.',
            'PEN': 'S/', 'PGK': 'K', 'PHP': '₱', 'PKR': '₨', 'PLN': 'zł',
            'PYG': '₲', 'QAR': 'ر.ق', 'RON': 'lei', 'RSD': 'дин.', 'RUB': '₽',
            'RWF': 'FRw', 'SAR': 'ر.س', 'SBD': '$', 'SCR': '₨', 'SDG': 'ج.س.',
            'SEK': 'kr', 'SGD': '$', 'SHP': '£', 'SLL': 'Le', 'SOS': 'S',
            'SRD': '$', 'SSP': '£', 'STN': 'Db', 'SVC': '₡', 'SYP': '£',
            'SZL': 'L', 'THB': '฿', 'TJS': 'ЅМ', 'TMT': 'T', 'TND': 'د.ت',
            'TOP': 'T$', 'TRY': '₺', 'TTD': 'TT$', 'TWD': 'NT$', 'TZS': 'TSh',
            'UAH': '₴', 'UGX': 'USh', 'UYU': '$U', 'UZS': "so'm", 'VES': 'Bs.',
            'VND': '₫', 'VUV': 'VT', 'WST': 'WS$', 'XAF': 'FCFA', 'XCD': 'EC$',
            'XOF': 'CFA', 'XPF': '₣', 'YER': '﷼', 'ZAR': 'R', 'ZMW': 'ZK',
            'ZWL': 'Z$'
        };

        // Currency data with regions and search terms
        const currencyData = {
            'Popular': {
                'USD': { name: 'US Dollar', flag: 'us', terms: ['usd', 'dollar', 'united states'] },
                'EUR': { name: 'Euro', flag: 'eu', terms: ['eur', 'euro', 'european union'] },
                'GBP': { name: 'British Pound', flag: 'gb', terms: ['gbp', 'pound', 'sterling', 'united kingdom'] },
                'JPY': { name: 'Japanese Yen', flag: 'jp', terms: ['jpy', 'yen', 'japan'] },
                'INR': { name: 'Indian Rupee', flag: 'in', terms: ['inr', 'rupee', 'india'] },
                'CNY': { name: 'Chinese Yuan', flag: 'cn', terms: ['cny', 'yuan', 'china', 'renminbi'] },
                'RUB': { name: 'Russian Ruble', flag: 'ru', terms: ['rub', 'ruble', 'russia'] }
            },
            'Asia': {
                'KRW': { name: 'South Korean Won', flag: 'kr', terms: ['krw', 'won', 'korea'] },
                'HKD': { name: 'Hong Kong Dollar', flag: 'hk', terms: ['hkd', 'hong kong'] },
                'SGD': { name: 'Singapore Dollar', flag: 'sg', terms: ['sgd', 'singapore'] },
                'IDR': { name: 'Indonesian Rupiah', flag: 'id', terms: ['idr', 'rupiah', 'indonesia'] },
                'MYR': { name: 'Malaysian Ringgit', flag: 'my', terms: ['myr', 'ringgit', 'malaysia'] },
                'PHP': { name: 'Philippine Peso', flag: 'ph', terms: ['php', 'peso', 'philippines'] },
                'THB': { name: 'Thai Baht', flag: 'th', terms: ['thb', 'baht', 'thailand'] },
                'VND': { name: 'Vietnamese Dong', flag: 'vn', terms: ['vnd', 'dong', 'vietnam'] },
                'BDT': { name: 'Bangladeshi Taka', flag: 'bd', terms: ['bdt', 'taka', 'bangladesh'] },
                'PKR': { name: 'Pakistani Rupee', flag: 'pk', terms: ['pkr', 'rupee', 'pakistan'] }
            },
            'Americas': {
                'CAD': { name: 'Canadian Dollar', flag: 'ca', terms: ['cad', 'canada'] },
                'BRL': { name: 'Brazilian Real', flag: 'br', terms: ['brl', 'real', 'brazil'] },
                'MXN': { name: 'Mexican Peso', flag: 'mx', terms: ['mxn', 'peso', 'mexico'] },
                'ARS': { name: 'Argentine Peso', flag: 'ar', terms: ['ars', 'peso', 'argentina'] },
                'CLP': { name: 'Chilean Peso', flag: 'cl', terms: ['clp', 'peso', 'chile'] },
                'COP': { name: 'Colombian Peso', flag: 'co', terms: ['cop', 'peso', 'colombia'] },
                'PEN': { name: 'Peruvian Sol', flag: 'pe', terms: ['pen', 'sol', 'peru'] },
                'UYU': { name: 'Uruguayan Peso', flag: 'uy', terms: ['uyu', 'peso', 'uruguay'] }
            },
            'Europe': {
                'CHF': { name: 'Swiss Franc', flag: 'ch', terms: ['chf', 'franc', 'switzerland'] },
                'SEK': { name: 'Swedish Krona', flag: 'se', terms: ['sek', 'krona', 'sweden'] },
                'NOK': { name: 'Norwegian Krone', flag: 'no', terms: ['nok', 'krone', 'norway'] },
                'DKK': { name: 'Danish Krone', flag: 'dk', terms: ['dkk', 'krone', 'denmark'] },
                'PLN': { name: 'Polish Złoty', flag: 'pl', terms: ['pln', 'zloty', 'poland'] },
                'CZK': { name: 'Czech Koruna', flag: 'cz', terms: ['czk', 'koruna', 'czech'] },
                'HUF': { name: 'Hungarian Forint', flag: 'hu', terms: ['huf', 'forint', 'hungary'] },
                'RON': { name: 'Romanian Leu', flag: 'ro', terms: ['ron', 'leu', 'romania'] },
                'BGN': { name: 'Bulgarian Lev', flag: 'bg', terms: ['bgn', 'lev', 'bulgaria'] },
                'HRK': { name: 'Croatian Kuna', flag: 'hr', terms: ['hrk', 'kuna', 'croatia'] },
                'ISK': { name: 'Icelandic Króna', flag: 'is', terms: ['isk', 'krona', 'iceland'] }
            },
            'Middle East': {
                'AED': { name: 'UAE Dirham', flag: 'ae', terms: ['aed', 'dirham', 'uae', 'emirates'] },
                'SAR': { name: 'Saudi Riyal', flag: 'sa', terms: ['sar', 'riyal', 'saudi'] },
                'QAR': { name: 'Qatari Riyal', flag: 'qa', terms: ['qar', 'riyal', 'qatar'] },
                'KWD': { name: 'Kuwaiti Dinar', flag: 'kw', terms: ['kwd', 'dinar', 'kuwait'] },
                'BHD': { name: 'Bahraini Dinar', flag: 'bh', terms: ['bhd', 'dinar', 'bahrain'] },
                'OMR': { name: 'Omani Rial', flag: 'om', terms: ['omr', 'rial', 'oman'] },
                'ILS': { name: 'Israeli Shekel', flag: 'il', terms: ['ils', 'shekel', 'israel'] },
                'JOD': { name: 'Jordanian Dinar', flag: 'jo', terms: ['jod', 'dinar', 'jordan'] }
            },
            'Africa': {
                'ZAR': { name: 'South African Rand', flag: 'za', terms: ['zar', 'rand', 'south africa'] },
                'EGP': { name: 'Egyptian Pound', flag: 'eg', terms: ['egp', 'pound', 'egypt'] },
                'NGN': { name: 'Nigerian Naira', flag: 'ng', terms: ['ngn', 'naira', 'nigeria'] },
                'KES': { name: 'Kenyan Shilling', flag: 'ke', terms: ['kes', 'shilling', 'kenya'] },
                'MAD': { name: 'Moroccan Dirham', flag: 'ma', terms: ['mad', 'dirham', 'morocco'] },
                'GHS': { name: 'Ghanaian Cedi', flag: 'gh', terms: ['ghs', 'cedi', 'ghana'] }
            },
            'Pacific': {
                'AUD': { name: 'Australian Dollar', flag: 'au', terms: ['aud', 'australia'] },
                'NZD': { name: 'New Zealand Dollar', flag: 'nz', terms: ['nzd', 'new zealand'] },
                'FJD': { name: 'Fijian Dollar', flag: 'fj', terms: ['fjd', 'fiji'] },
                'PGK': { name: 'Papua New Guinean Kina', flag: 'pg', terms: ['pgk', 'papua'] },
                'SBD': { name: 'Solomon Islands Dollar', flag: 'sb', terms: ['sbd', 'solomon'] }
            }
        };

        // Enhanced styling for currency selector
        const style = document.createElement('style');
        style.textContent = `
            .custom-select-option {
                padding: 12px 15px;
                border-bottom: 1px solid #f0f0f0;
            }
            .custom-select-option:last-child {
                border-bottom: none;
            }
            .custom-select-option:hover {
                background-color: #f8f9fa;
            }
            .currency-flag {
                width: 32px !important;
                height: 24px !important;
                border-radius: 4px;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            .currency-code {
                font-weight: 600;
                color: #333;
                min-width: 60px;
            }
            .currency-name {
                color: #666;
                font-size: 0.95em;
            }
            .currency-group {
                background: #f8f9fa;
                padding: 10px 15px;
                font-weight: 600;
                color: #495057;
                position: sticky;
                top: 0;
                z-index: 2;
                border-bottom: 2px solid #e9ecef;
            }
            .currency-search input {
                padding: 12px 15px;
                border-radius: 8px;
                border: 1px solid #dee2e6;
                width: 100%;
                margin-bottom: 8px;
            }
            .currency-search input:focus {
                border-color: #0d6efd;
                box-shadow: 0 0 0 0.25rem rgba(13,110,253,.25);
                outline: none;
            }
            #currencySearch {
                padding-left: 45px;
                background-position: 8px center;
                background-repeat: no-repeat;
                background-size: 32px 24px;
            }
        `;
        document.head.appendChild(style);

        // Initialize currency selector
        function initializeCurrencySelector() {
            const selectedCurrency = document.getElementById('selectedCurrency');
            const currencyDropdown = document.getElementById('currencyDropdown');
            const searchInput = document.getElementById('currencySearchInput');
            const currencyList = document.getElementById('currencyList');

            // Toggle dropdown when clicking on selected currency
            selectedCurrency.addEventListener('click', () => {
                currencyDropdown.classList.toggle('show');
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.currency-select-container')) {
                    currencyDropdown.classList.remove('show');
                }
            });

            // Search functionality
            searchInput.addEventListener('input', (e) => {
                populateCurrencyList(e.target.value);
            });

            // Initial population
            populateCurrencyList();
        }

        // Populate currency list
        function populateCurrencyList(filter = '') {
            const currencyList = document.getElementById('currencyList');
            currencyList.innerHTML = '';
            let hasResults = false;

            for (const [region, currencies] of Object.entries(currencyData)) {
                const filteredCurrencies = Object.entries(currencies).filter(([code, data]) => {
                    const searchTerms = [code.toLowerCase(), data.name.toLowerCase(), ...data.terms];
                    return searchTerms.some(term => term.includes(filter.toLowerCase()));
                });

                if (filteredCurrencies.length > 0) {
                    hasResults = true;
                    const groupDiv = document.createElement('div');
                    groupDiv.className = 'currency-group';
                    groupDiv.textContent = region;
                    currencyList.appendChild(groupDiv);

                    filteredCurrencies.forEach(([code, data]) => {
                        const option = document.createElement('div');
                        option.className = 'currency-option';
                        option.innerHTML = `
                            <img src="https://flagcdn.com/w40/${data.flag}.png" 
                                 alt="${data.name} flag" 
                                 class="currency-flag"
                                 loading="lazy">
                            <span class="currency-code">${code}</span>
                            <span class="currency-name">${data.name}</span>
                        `;
                        option.addEventListener('click', () => selectCurrency(code, data));
                        currencyList.appendChild(option);
                    });
                }
            }

            if (!hasResults) {
                const noResults = document.createElement('div');
                noResults.className = 'no-results';
                noResults.textContent = 'No currencies found';
                currencyList.appendChild(noResults);
            }
        }

        // Select currency function
        function selectCurrency(code, data) {
            const selectedFlag = document.getElementById('selectedFlag');
            const selectedCode = document.getElementById('selectedCode');
            const selectedName = document.getElementById('selectedName');
            const currencyDropdown = document.getElementById('currencyDropdown');
            
            // Update selected currency display
            selectedFlag.src = `https://flagcdn.com/w40/${data.flag}.png`;
            selectedFlag.alt = `${data.name} flag`;
            selectedCode.textContent = code;
            selectedName.textContent = data.name;
            
            // Update currency symbol
            document.getElementById('currencySymbol').textContent = currencySymbols[code];
            
            // Hide dropdown
            currencyDropdown.classList.remove('show');
            
            // Update all currency displays and recalculate
            updateCurrencySymbols(code);
            calculateEMI();
        }

        // Update currency symbols function
        function updateCurrencySymbols(currencyCode) {
            const symbol = currencySymbols[currencyCode];
            
            // Update input group currency symbol
            document.getElementById('currencySymbol').textContent = symbol;
            
            // Update all result values
            const results = ['monthlyEMI', 'totalInterest', 'totalPayment'];
            results.forEach(id => {
                const element = document.getElementById(id);
                if (element && element.textContent) {
                    const value = element.textContent.replace(/[^0-9.]/g, '');
                    if (value !== '') {
                        element.textContent = symbol + value;
                    }
                }
            });
            
            // Update amortization table
            const table = document.getElementById('amortizationTable');
            if (table) {
                const cells = table.getElementsByTagName('td');
                for (let cell of cells) {
                    const value = cell.textContent.replace(/[^0-9.]/g, '');
                    if (cell.textContent.match(/[₹$€£¥]/)) {
                        cell.textContent = symbol + value;
                    }
                }
            }
        }

        // Initialize currency selector when page loads
        document.addEventListener('DOMContentLoaded', () => {
            initializeCurrencySelector();
            
            // Set default currency (USD)
            selectCurrency('USD', currencyData['Popular']['USD']);
            
            // Add input event listeners for real-time calculation
            const inputs = ['loanAmount', 'interestRate', 'loanTerm'];
            inputs.forEach(id => {
                document.getElementById(id).addEventListener('input', calculateEMI);
            });
            document.getElementById('termType').addEventListener('change', calculateEMI);
        });

        // Calculate EMI function
        function calculateEMI() {
            const loanAmount = parseFloat(document.getElementById('loanAmount').value);
            const interestRate = parseFloat(document.getElementById('interestRate').value);
            const loanTerm = parseFloat(document.getElementById('loanTerm').value);
            const termType = parseInt(document.getElementById('termType').value);
            
            // Get currency code from the selected currency display
            const currencyCode = document.getElementById('selectedCode').textContent || 'USD';
            const symbol = currencySymbols[currencyCode] || '$';

            if (!loanAmount || !interestRate || !loanTerm) {
                return; // Don't show alert, just return silently
            }

            // Convert annual rate to monthly rate
            const monthlyRate = (interestRate / 12) / 100;
            // Calculate total months
            const totalMonths = loanTerm * termType;

            // Calculate EMI
            const emi = loanAmount * monthlyRate * Math.pow(1 + monthlyRate, totalMonths) / (Math.pow(1 + monthlyRate, totalMonths) - 1);
            const totalPayment = emi * totalMonths;
            const totalInterest = totalPayment - loanAmount;

            // Display results with selected currency symbol
            document.getElementById('monthlyEMI').textContent = `${symbol}${emi.toFixed(2)}`;
            document.getElementById('totalInterest').textContent = `${symbol}${totalInterest.toFixed(2)}`;
            document.getElementById('totalPayment').textContent = `${symbol}${totalPayment.toFixed(2)}`;

            // Generate amortization schedule
            generateAmortizationSchedule(loanAmount, monthlyRate, emi, totalMonths, symbol);

            // Update chart
            updateChart(loanAmount, totalInterest);
        }

        // Generate amortization schedule
        function generateAmortizationSchedule(loanAmount, monthlyRate, emi, totalMonths, symbol) {
            const tbody = document.getElementById('amortizationTable').getElementsByTagName('tbody')[0];
            tbody.innerHTML = '';

            let remainingBalance = loanAmount;
            for (let month = 1; month <= totalMonths; month++) {
                const interest = remainingBalance * monthlyRate;
                const principal = emi - interest;
                remainingBalance -= principal;

                const row = tbody.insertRow();
                row.insertCell(0).textContent = month;
                row.insertCell(1).textContent = symbol + emi.toFixed(2);
                row.insertCell(2).textContent = symbol + principal.toFixed(2);
                row.insertCell(3).textContent = symbol + interest.toFixed(2);
                row.insertCell(4).textContent = symbol + Math.abs(remainingBalance).toFixed(2);
            }
        }

        // Update chart
        function updateChart(principal, totalInterest) {
            const ctx = document.getElementById('loanChart').getContext('2d');
            
            if (loanChart) {
                loanChart.destroy();
            }

            loanChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Principal', 'Total Interest'],
                    datasets: [{
                        data: [principal, totalInterest],
                        backgroundColor: ['#0d6efd', '#dc3545'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }
    </script>
</body>
</html> 